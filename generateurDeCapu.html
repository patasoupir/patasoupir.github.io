<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>générateurDeCapu</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
      /* --- CSS complet corrigé (voir plus bas aussi) --- */
      html,
      body,
      * {
        box-sizing: border-box;
      }
      body {
        font-family: "Arial", sans-serif;
        background-color: rgb(255, 1, 255);
        font-size: 15pt;
        border: 10px blue dotted;
        padding: 10px;
        margin: 0;
      }

      main {
        /* border-image nécessite aussi une bordure (border-style) */
        border: 10px solid transparent;
        border-image: url("img/capugifi.gif") 100 fill / 250px / 1px space;
        padding: 10px;
      }

      #startButton {
        position: relative;
        margin: 0 auto;
        padding: 30px;
        width: 70%;
        font-family: Arial, sans-serif;
        font-weight: bold;
        background-color: transparent;
        border: 10px solid transparent; /* nécessaire pour border-image */
        color: yellow;
        font-size: 50pt;
        border-image: url("img/capu1.jpg") 50 fill / 25px / 10px space;
        display: block;
      }
      #startButton:hover {
        background-color: transparent;
        border: 10px solid transparent;
        cursor: pointer;
        font-size: 20pt;
        color: rgb(1, 43, 255);
      }

      .mainBox {
        display: flex;
        flex-direction: column;
        margin: 0 auto;
        min-height: 100vh;
        align-items: center;
        justify-content: center;
        padding: 10px;
        text-align: center;
        border: 10px solid transparent; /* pareil pour border-image */
        border-image: url("img/étoile.png") 70 fill / 20px / 10px space;
        gap: 20px;
        width: 100%;
        overflow: hidden;
      }

      .header {
        background-color: rgb(255, 1, 255);
        text-align: center;
        font-family: "Arial", sans-serif;
        font-style: italic;
        font-size: 30pt;
        color: rgb(255, 1, 255);
        background-color: yellow;
        margin: 0;
        animation: leftToRight 5s infinite;
      }
      @keyframes leftToRight {
        0% {
          transform: translate3d(-100%, 0, 0);
        }
        100% {
          transform: translate3d(100%, 0, 0);
        }
      }

      /* --- bouton charger --- */
      #loadData {
        padding: 15px;
        font-family: Arial, sans-serif;
        font-size: 15pt;
        width: auto;
        border: 10px solid blue;
        color: rgb(255, 1, 255);
        font-weight: bold;
        cursor: pointer;
        background: none;
        background-color: white;
      }
      #loadData:hover {
        background-color: rgb(255, 1, 255);
        color: white;
      }

      /* --- LA BOÎTE PRENOM corrigée --- */
      #prenomBox {
        display: flex;
        flex-direction: column;
        background-color: white;
        text-align: center;
        align-items: center;
        justify-content: center;

        border: 10px solid transparent;
        border-image: url("img/capu1.jpg") 10 / 20px / 10px;
        font-size: 14pt;
        gap: 4px;

        /* tailles flexibles */
        min-width: 300px; /* empêche que ça devienne trop étroit */
        max-width: 90vw; /* ne dépasse jamais 90% de l’écran */
        padding: 16px;
        box-sizing: border-box; /* espace intérieur pour visualiser */
      }

      #prenomBox:hover {
        border: 10px solid transparent;
        border-image: url("img/capu1.jpg") 100 fill / 50px / 10px repeat;
        color: transparent;
      }

      .hidden {
        display: none;
      }
      .motEntier {
        white-space: nowrap;
        display: inline-block;
      }
      .premiereLettre {
        color: rgb(0, 8, 255);
        font-weight: 700;
      }
      .capuImg img {
        width: 50px;
        height: 50px;
      }

      /* --- media queries (correctement fermées) --- */
      @media only screen and (max-width: 820px) {
        body {
          width: 100%;
          margin: 0 auto;
          padding: 0;
        }
        .header {
          font-size: 25pt;
          margin: 0;
          padding: 0;
          animation: leftToRight 10s infinite;
          display: inline-block;
        }
        @keyframes leftToRight {
          0% {
            transform: translate3d(-100%, 0, 0);
          }
          100% {
            transform: translate3d(100%, 0, 0);
          }
        }

        #startButton {
          border: 10px solid transparent;
          border-image: url("img/capu1.jpg") 80 fill / 20px / 10px space;
          font-size: 20pt;
          box-shadow: 2px 2px 5px black;
          text-align: center;
        }

        .mainBox {
          height: auto;
          text-align: center;

          padding: 0;
          border: 10px solid transparent;
          border-image: url("img/étoile.png") 70 fill / 20px / 10px space;
          overflow: hidden;
        }

        #loadData {
          width: 100%;
        }

        #prenomBox {
          width: auto;
          min-width: 60vw;
          max-width: 90vw;
          margin: 0;
          box-sizing: border-box;
          height: auto;
          padding: 50px;
          border: none;
          line-height: 1;
          font-size: 0.9em;
          margin: 0 auto;

          /* border-image: url("img/capu1.jpg") 110 / 15px / 10px space; */
          text-align: center;
        }

        .imgHidden {
          display: none;
        }
      }
    </style>
  </head>
  <body>
    <main>
      <!-- Bouton d'entrée -->
      <div class="mainBox" id="startScreen">
        <button id="startButton">bonjour capucine...</button>
      </div>

      <!-- Contenu principal caché au début -->
      <div class="mainBox hidden" id="appContent">
        <div class="header">HAPPY HALLOWEEN !!!!!!!!!!!</div>
        <button id="loadData">
          <span id="blinkAnimation">t'en veux encore ??????????</span>
        </button>
        <audio id="sound1" src="son/dems1.mp3"></audio>
        <audio id="sound2" src="son/dems1AIGU.mp3"></audio>

        <div id="prenomBox"></div>

        <div class="capuImg">
          <img src="img/capu1.jpg" /> <img src="img/capu1.jpg" /><img
            src="img/capu1.jpg"
          />
          <img src="img/capu1.jpg" /><img src="img/capu1.jpg" /><img
            class="imgHidden"
            src="img/capu1.jpg"
          />
          <img class="imgHidden" src="img/capu1.jpg" /><img
            class="imgHidden"
            src="img/capu1.jpg"
          /><img class="imgHidden" src="img/capu1.jpg" />
        </div>
      </div>

      <script>
        let C1 = [],
          A = [],
          P = [],
          U = [],
          C2 = [],
          I = [],
          N = [],
          E = [];

        function formatWord(word = "", letter = "") {
          const first = letter.toUpperCase();
          const rest = String(word).slice(1);
          return `<span class="motEntier"><span class="premiereLettre">${first}</span>${rest}</span>`;
        }

        // Passage de l'écran start au vrai contenu
        const startButton = document.getElementById("startButton");
        const startScreen = document.getElementById("startScreen");
        const appContent = document.getElementById("appContent");

        startButton.addEventListener("click", () => {
          startScreen.classList.add("hidden");
          appContent.classList.remove("hidden");
        });

        // Génération prénom
        function generatePrenom() {
          let prenom =
            formatWord(C1[Math.floor(Math.random() * C1.length)], "C") +
            "<br>" +
            formatWord(A[Math.floor(Math.random() * A.length)], "A") +
            "<br>" +
            formatWord(P[Math.floor(Math.random() * P.length)], "P") +
            "<br>" +
            formatWord(U[Math.floor(Math.random() * U.length)], "U") +
            "<br>" +
            formatWord(C2[Math.floor(Math.random() * C2.length)], "C") +
            "<br>" +
            formatWord(I[Math.floor(Math.random() * I.length)], "I") +
            "<br>" +
            formatWord(N[Math.floor(Math.random() * N.length)], "N") +
            "<br>" +
            formatWord(E[Math.floor(Math.random() * E.length)], "E");

          d3.select("#prenomBox").html(prenom);
        }

        // Chargement CSV
        const csvUrl =
          "https://docs.google.com/spreadsheets/d/e/2PACX-1vTdImm57iA75bA0jj1vyRr2U0uXiwXJ1kvEm783QMUiO0GNk2UeVM6hSfKHN1ex0Ly4JCOmutjyLqP4/pub?gid=0&single=true&output=csv";

        d3.csv(csvUrl).then((data) => {
          data.forEach((d) => {
            if (d.lettreC1) C1.push(d.lettreC1);
            if (d.lettreA) A.push(d.lettreA);
            if (d.lettreP) P.push(d.lettreP);
            if (d.lettreU) U.push(d.lettreU);
            if (d.lettreC2) C2.push(d.lettreC2);
            if (d.lettreI) I.push(d.lettreI);
            if (d.lettreN) N.push(d.lettreN);
            if (d.lettreE) E.push(d.lettreE);
          });
        });

        // Sons
        const loadButton = document.getElementById("loadData");
        const sound1 = document.getElementById("sound1");
        const sound2 = document.getElementById("sound2");
        let clickCount = 0;

        startButton.addEventListener("click", () => {
          sound1.play();
          generatePrenom();
        });
        loadButton.addEventListener("click", () => {
          sound2.play();
          generatePrenom();
        });
      </script>
    </main>
  </body>
</html>
